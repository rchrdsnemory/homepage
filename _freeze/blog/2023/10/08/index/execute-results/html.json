{
  "hash": "cd6f1b4858430607cd0e0658d8cc64e9",
  "result": {
    "markdown": "---\ntitle: 'Using GPT-4 for classification'\ndate: 2023-10-08\ndescription: \"In this post I'll be tackling the Tidy Tuesday: US Government Grant Opportunities dataset. I'll use GPT-4 to classify US grant-funding agencies into categories using government agency names. Then I'll summarize how much agencies in each category are estimated to be giving out through grants.\"\nimage: social-image.png\ntwitter-card:\n  image: \"social-image.png\"\nopen-graph:\n  image: \"social-image.png\"\ncategories:\n  - GPT\n  - classification\n  - R\nfreeze: true\n---\n\n\nGPT is a powerful new tool in the Data Science toolkit. Used correctly, it can increase productivity while decreasing the \"drudgery\" of boring tasks like data cleaning. In this blog post, I use GPT to classify US grant-funding agencies into categories using government agency names. For this task I'll be using this week's Tidy Tuesday dataset: [US Government Grant Opportunities](https://github.com/rfordatascience/tidytuesday/blob/master/data/2023/2023-10-03/readme.md).\n\n# Load libraries and data\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(tidyverse)\nlibrary(DescTools)\nlibrary(keyring)\nlibrary(httr)\nlibrary(jsonlite)\nlibrary(numform)\nlibrary(scales)\nlibrary(snakecase)\n\ngrants <- readr::read_csv('https://raw.githubusercontent.com/rfordatascience/tidytuesday/master/data/2023/2023-10-03/grants.csv')\ngrant_opportunity_details <- readr::read_csv('https://raw.githubusercontent.com/rfordatascience/tidytuesday/master/data/2023/2023-10-03/grant_opportunity_details.csv')\n\n# Load cached ChatGPT results from disk\nload('categories.Rdata')\nload('agencies_categorized.Rdata')\n```\n:::\n\n\n# GPT function\n\nI'll define a function for querying ChatGPT ([source](https://www.listendata.com/2023/05/chatgpt-in-r.html)). This function will use GPT-4 as the model, and the temperature will be set to 0. Temperature defines how stable the responses will be. A temperature closer to 1 is better for creative tasks where high variability is desired, like creative writing. A temperature of 0 is more \"boring\" but also more stable. This is desirable for classification tasks.\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# ChatGPT function\nchatGPT <- function(prompt, \n                    modelName = \"gpt-4\",\n                    temperature = 0,\n                    apiKey = keyring::key_get('openai')) {\n  \n  response <- POST(\n    url = \"https://api.openai.com/v1/chat/completions\", \n    add_headers(Authorization = paste(\"Bearer\", apiKey)),\n    content_type_json(),\n    encode = \"json\",\n    body = list(\n      model = modelName,\n      temperature = temperature,\n      messages = list(list(\n        role = \"user\", \n        content = prompt\n      ))\n    )\n  )\n  \n  if(status_code(response)>200) {\n    stop(content(response))\n  }\n  \n  trimws(content(response)$choices[[1]]$message$content)\n}\n```\n:::\n\n\n# List of agencies\n\nI'll generate a distinct list of US government agencies in the dataset, and then format them as a comma-separated string. This will make it easy to append to a prompt string when querying GPT.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nagencies <- sort(unique(grants$agency_name))\npaste0(agencies,collapse = ', ') -> agencies_str\n```\n:::\n\n\n# Using GPT for classification\n\nI'll split the classification task into two parts:\n\n1. Give GPT the full list of agency names, and ask it to come up with N categories\n2. For each of the N categories, give GPT the full list of agency names, and ask it to identify the agencies that belong in each category\n\n# 1. Ask it to come up with categories\n\nFirst I'll ask GPT to define a fixed number of categories. Somewhat arbitrarily, I'll ask for 10.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nif(!exists('categories')){\n  query1 <- \n  paste0(\n  \"I'm going to present a list of US agencies. \n  Your task is to identify the 10 best categories \n  to represent them. The categories should be based \n  on activities they're involved with, such as Defense \n  and Military, Science and Technology, Arts and Culture, \n  Health and Medicine, Education, International Aid, \n  etc... I want you to give me the list of categories \n  as a comma-separated list.\n  \n  ```\", agencies_str, \"```\"\n  )\n  gpt_categories <- chatGPT(query1)\n  \n  categories <- trimws(strsplit(gpt_categories, \",\")[[1]])\n  \n  # Save to disk\n  save(categories, file = 'categories.Rdata')\n}\n\nprint(categories)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n [1] \"Defense and Military\"                     \n [2] \"Science and Technology\"                   \n [3] \"Health and Medicine\"                      \n [4] \"International Aid\"                        \n [5] \"Education and Research\"                   \n [6] \"Agriculture and Environment\"              \n [7] \"Infrastructure and Transportation\"        \n [8] \"Business and Economic Development\"        \n [9] \"Arts and Culture\"                         \n[10] \"Social Services and Community Development\"\n```\n:::\n:::\n\n\n## 2. Ask it to classify agencies using agency names and categories\n\nNext, using the agency names and categories generated above I'll ask GPT to do classification. First, I'll define a function that takes a category as input and runs a query against GPT asking it to put the agencies into the provided category, returning a list of agencies that it put in that category. Although I could ask GPT to classify agencies using all categories in a single query, I expect this would be less reliable than tackling each category separately. One of the trade-offs here is that I won't get mutual exclusivity of the categories, since GPT won't know how it's already classified agencies. For this analysis, let's assume I don't want mutual exclusivity.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nget_agencies_in_category <- function(category) {\n  query2 <-paste0(\n  \"I'm going to present a comma-separated list of US agencies,\n  delimited by triple backticks (```), and a single category to \n  which some of the agencies belong, delimited by triple hashtags (###). \n  Your task is to provide a comma-separated list of agency names that \n  belong in the category provided.\n  ```\", agencies_str,  \"```\n  ###\", category, \"###\"\n  )\n  gpt_query2_response <- chatGPT(query2)\n  \n  # Return as a vector\n  trimws(strsplit(gpt_query2_response, \",\")[[1]])\n}\n```\n:::\n\n\nUsing the function above, I'll query GPT for each of the categories, saving the results into a list called `agencies_categorized`.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nif(!exists('agencies_categorized')){\n  agencies_categorized <- list()\n  for (category in categories){\n    if(category != 'Other'){\n      agencies_categorized[[category]] <- get_agencies_in_category(category) \n    }\n  }\n  \n  # Save to disk\n  save(agencies_categorized, file = 'agencies_categorized.Rdata')\n}\n  \nprint(agencies_categorized)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n$`Defense and Military`\n [1] \"69A345 Office of the Under Secretary for Policy\"   \n [2] \"69A350 OSDBU\"                                      \n [3] \"69A355 Research and Technology\"                    \n [4] \"ACC APG - Natick\"                                  \n [5] \"ACC-APG-Aberdeen Division A\"                       \n [6] \"ACC-APG-Belvoir\"                                   \n [7] \"ACC-APG-Detrick\"                                   \n [8] \"ACC-APG-Edgewood\"                                  \n [9] \"ACC-APG-Fort Huachuca\"                             \n[10] \"Air Force -- Materiel Command\"                     \n[11] \"Air Force -- Research Lab\"                         \n[12] \"Air Force Academy\"                                 \n[13] \"Air Force Office of Scientific Research\"           \n[14] \"Alaska District\"                                   \n[15] \"Army Contracting Command - Benet Laboratories\"     \n[16] \"Army Contracting Command - New Jersey\"             \n[17] \"Army Contracting Command Rock Island\"              \n[18] \"Bureau of Diplomatic Security\"                     \n[19] \"Bureau of International Security-Nonproliferation\" \n[20] \"Bureau of Political-Military Affairs - GPI\"        \n[21] \"Bureau of Political-Military Affairs - WRA\"        \n[22] \"DARPA - Biological Technologies Office\"            \n[23] \"DARPA - Defense Sciences Office\"                   \n[24] \"DARPA - Information Innovation Office\"             \n[25] \"DARPA - Information Processing Technology Office\"  \n[26] \"DARPA - Microsystems Technology Office\"            \n[27] \"DARPA - Strategic Technology Office\"               \n[28] \"DARPA - Tactical Technology Office\"                \n[29] \"DARPA - Transformational Convergence Technology\"   \n[30] \"DARPA-MTO-BAA-09-25\"                               \n[31] \"Defense Advanced Research Projects Agency\"         \n[32] \"Defense Health Agency\"                             \n[33] \"Defense Intelligence Agency\"                       \n[34] \"Defense Logistics Agency\"                          \n[35] \"Defense Threat Reduction Agency\"                   \n[36] \"Department of Defense\"                             \n[37] \"Dept of the Army -- Materiel Command\"              \n[38] \"Dept. of the Army  --  Corps of Engineers\"         \n[39] \"Dept. of the Army -- Space & Missle Defense Comman\"\n[40] \"Dept. of the Army -- USAMRAA\"                      \n[41] \"DoD Education Activity\"                            \n[42] \"DOT - FAA Aviation Research Grants\"                \n[43] \"DOT - FAA Centers of Excellence\"                   \n[44] \"DOT Federal Aviation Administration\"               \n[45] \"Engineer Research and Development Center\"          \n[46] \"Fort Worth District\"                               \n[47] \"Kansas City District\"                              \n[48] \"Missile Defense Agency\"                            \n[49] \"Mission and Install. Cmd. JBSA Ft. Sam Houston\"    \n[50] \"NAVAIR\"                                            \n[51] \"Naval Air Warfare Center Aircraft Div. Lakehurst\"  \n[52] \"NAVAL FACILITIES ENGINEERING COMMAND\"              \n[53] \"Naval Facilities Engineering Command Southwest\"    \n[54] \"Naval Information Warfare Center Pacific\"          \n[55] \"NAVAL MEDICAL LOGISTICS COMMAND\"                   \n[56] \"Naval Research Laboratory\"                         \n[57] \"Naval Supply Systems Command\"                      \n[58] \"Naval Surface Warfare Center - Carderock\"          \n[59] \"NAVFAC Atlantic\"                                   \n[60] \"NAVFAC Washington DC\"                              \n[61] \"NCA Contracting\"                                   \n[62] \"NEA Cooperative Agreements Office\"                 \n[63] \"NSWC - CRANE\"                                      \n[64] \"NSWC Indian Head\"                                  \n[65] \"NUWC Division Keyport\"                             \n[66] \"Office of Local Defense Community Cooperation\"     \n[67] \"Office of Naval Research\"                          \n[68] \"Office of the Director of National Intelligence\"   \n[69] \"Omaha District\"                                    \n[70] \"Savannah District\"                                 \n[71] \"Seattle District\"                                  \n[72] \"SPAWAR SYSTEMS CENTER\"                             \n[73] \"U.S. Dept. of Treasury RESTORE Act Program\"        \n[74] \"U.S. Mission to NATO\"                              \n[75] \"United States Coast Guard\"                         \n[76] \"United States Marine Corps\"                        \n[77] \"USAF 347 Contracting Squadron\"                     \n[78] \"Washington Headquarters Services\"                  \n\n$`Science and Technology`\n [1] \"69A345 Office of the Under Secretary for Policy\"   \n [2] \"69A355 Research and Technology\"                    \n [3] \"Advanced Research Projects Agency Energy\"          \n [4] \"Advanced Research Projects Agency for Health\"      \n [5] \"Agency for Health Care Research and Quality\"       \n [6] \"Agricultural Research Service\"                     \n [7] \"Air Force -- Research Lab\"                         \n [8] \"Air Force Office of Scientific Research\"           \n [9] \"Army Contracting Command - Benet Laboratories\"     \n[10] \"Bureau of Oceans - Int. Environmental - Scientific\"\n[11] \"Centers for Disease Control - ATSDR\"               \n[12] \"Centers for Disease Control - CFA\"                 \n[13] \"Centers for Disease Control - CGH\"                 \n[14] \"Centers for Disease Control - CSELS\"               \n[15] \"Centers for Disease Control - NCBDDD\"              \n[16] \"Centers for Disease Control - NCCDPHP\"             \n[17] \"Centers for Disease Control - NCEH\"                \n[18] \"Centers for Disease Control - NCEZID\"              \n[19] \"Centers for Disease Control - NCHHSTP\"             \n[20] \"Centers for Disease Control - NCHS\"                \n[21] \"Centers for Disease Control - NCIPC\"               \n[22] \"Centers for Disease Control - NCIRD\"               \n[23] \"Centers for Disease Control - NIOSH\"               \n[24] \"Centers for Disease Control - OD\"                  \n[25] \"Centers for Disease Control - OPHPR\"               \n[26] \"Centers for Disease Control - OSTLTS\"              \n[27] \"Centers for Disease Control and Prevention\"        \n[28] \"Centers for Disease Control and Prevention - ERA\"  \n[29] \"DARPA - Biological Technologies Office\"            \n[30] \"DARPA - Defense Sciences Office\"                   \n[31] \"DARPA - Information Innovation Office\"             \n[32] \"DARPA - Information Processing Technology Office\"  \n[33] \"DARPA - Microsystems Technology Office\"            \n[34] \"DARPA - Strategic Technology Office\"               \n[35] \"DARPA - Tactical Technology Office\"                \n[36] \"DARPA - Transformational Convergence Technology\"   \n[37] \"Defense Advanced Research Projects Agency\"         \n[38] \"Defense Health Agency\"                             \n[39] \"Defense Intelligence Agency\"                       \n[40] \"Defense Threat Reduction Agency\"                   \n[41] \"Department of Energy\"                              \n[42] \"DoD Education Activity\"                            \n[43] \"DOT - FAA Aviation Research Grants\"                \n[44] \"DOT - FAA Centers of Excellence\"                   \n[45] \"DOT Federal Aviation Administration\"               \n[46] \"Economic Research Service\"                         \n[47] \"Engineer Research and Development Center\"          \n[48] \"Environmental Protection Agency\"                   \n[49] \"FAA - Aviation Next Gen\"                           \n[50] \"FAA-COE-AJFE\"                                      \n[51] \"FAA-COE-GA\"                                        \n[52] \"FAA-COE-TTHP\"                                      \n[53] \"Food and Drug Administration\"                      \n[54] \"Geological Survey\"                                 \n[55] \"Health Resources and Services Administration\"      \n[56] \"Indian Health Service\"                             \n[57] \"Institute of Museum and Library Services\"          \n[58] \"National Aeronautics and Space Administration\"     \n[59] \"National Energy Technology Laboratory\"             \n[60] \"National Geospatial-Intelligence Agency\"           \n[61] \"National Highway Traffic Safety Administration\"    \n[62] \"National Institute of Food and Agriculture\"        \n[63] \"National Institute of Justice\"                     \n[64] \"National Institute of Standards and Technology\"    \n[65] \"National Institutes of Health\"                     \n[66] \"National Oceanic and Atmospheric Administration\"   \n[67] \"National Park Service\"                             \n[68] \"National Science Foundation\"                       \n[69] \"National Telecommunications and Information Admini\"\n[70] \"Naval Research Laboratory\"                         \n[71] \"Naval Supply Systems Command\"                      \n[72] \"Naval Surface Warfare Center - Carderock\"          \n[73] \"NNSA\"                                              \n[74] \"Nuclear Regulatory Commission\"                     \n[75] \"NUWC Division Keyport\"                             \n[76] \"Oak Ridge Office\"                                  \n[77] \"Office of Science\"                                 \n[78] \"Office of the Assistant Secretary for Health\"      \n[79] \"Office of the Director of National Intelligence\"   \n[80] \"Office of the National Coordinator\"                \n[81] \"Pipeline and Hazardous Materials Safety Admin\"     \n[82] \"Risk Management Agency\"                            \n[83] \"Science and Technology Directorate\"                \n[84] \"Substance Abuse and Mental Health Services Admin\"  \n[85] \"Substance Abuse and Mental Health Services Adminis\"\n[86] \"Uniformed Services Univ. of the Health Sciences\"   \n[87] \"USUHS Medical - Non- Research Projects\"            \n[88] \"USUHS Medical Research Projects\"                   \n[89] \"USAID\"                                             \n[90] \"Woodrow Wilson Center\"                             \n\n$`Health and Medicine`\n [1] \"Administration for Children & Families - ACYF/FYSB\"\n [2] \"Administration for Children and Families\"          \n [3] \"Administration for Children and Families - ACYF/CB\"\n [4] \"Administration for Children and Families - ANA\"    \n [5] \"Administration for Children and Families - OCC\"    \n [6] \"Administration for Children and Families - OCS\"    \n [7] \"Administration for Children and Families - OCSE\"   \n [8] \"Administration for Children and Families - OFA\"    \n [9] \"Administration for Children and Families - OHS\"    \n[10] \"Administration for Children and Families - OHSEPR\" \n[11] \"Administration for Children and Families - OPRE\"   \n[12] \"Administration for Children and Families - ORR\"    \n[13] \"Administration for Children and Families-IOAS-OTIP\"\n[14] \"Administration for Community Living\"               \n[15] \"Administration on Aging\"                           \n[16] \"Advanced Research Projects Agency for Health\"      \n[17] \"Agency for Health Care Research and Quality\"       \n[18] \"Centers for Disease Control - ATSDR\"               \n[19] \"Centers for Disease Control - CFA\"                 \n[20] \"Centers for Disease Control - CGH\"                 \n[21] \"Centers for Disease Control - CSELS\"               \n[22] \"Centers for Disease Control - NCBDDD\"              \n[23] \"Centers for Disease Control - NCCDPHP\"             \n[24] \"Centers for Disease Control - NCEH\"                \n[25] \"Centers for Disease Control - NCEZID\"              \n[26] \"Centers for Disease Control - NCHHSTP\"             \n[27] \"Centers for Disease Control - NCHS\"                \n[28] \"Centers for Disease Control - NCIPC\"               \n[29] \"Centers for Disease Control - NCIRD\"               \n[30] \"Centers for Disease Control - NIOSH\"               \n[31] \"Centers for Disease Control - OD\"                  \n[32] \"Centers for Disease Control - OPHPR\"               \n[33] \"Centers for Disease Control - OSTLTS\"              \n[34] \"Centers for Disease Control and Prevention\"        \n[35] \"Centers for Disease Control and Prevention - ERA\"  \n[36] \"Centers for Medicare & Medicaid Services\"          \n[37] \"CMS Consumer Operated and Oriented Plan Program\"   \n[38] \"CMS-Consumer Information & Insurance Oversight\"    \n[39] \"Defense Health Agency\"                             \n[40] \"Department of Health and Human Services\"           \n[41] \"Food and Drug Administration\"                      \n[42] \"Health Resources and Services Administration\"      \n[43] \"Indian Health Service\"                             \n[44] \"National Institute of Food and Agriculture\"        \n[45] \"National Institutes of Health\"                     \n[46] \"Office of the Assistant Secretary for Health\"      \n[47] \"Office of the National Coordinator\"                \n[48] \"Substance Abuse and Mental Health Services Admin\"  \n[49] \"Substance Abuse and Mental Health Services Adminis\"\n[50] \"Uniformed Services Univ. of the Health Sciences\"   \n[51] \"USUHS Medical - Non- Research Projects\"            \n[52] \"USUHS Medical Research Projects\"                   \n[53] \"VA Office of Mental Health\"                        \n[54] \"VHA Member Services-Veterans Transportation\"       \n\n$`International Aid`\n [1] \"Afghanistan USAID-Kabul\"                        \n [2] \"Africa Regional Services\"                       \n [3] \"Agency for International Development\"           \n [4] \"Albania USAID-Tirana\"                           \n [5] \"Armenia USAID-Yerevan\"                          \n [6] \"Azerbaijan USAID-Baku\"                          \n [7] \"Bangladesh USAID-Dhaka\"                         \n [8] \"Benin USAID-Cotonou\"                            \n [9] \"Bolivia USAID-La Paz\"                           \n[10] \"Bosnia USAID-Herzegovina\"                       \n[11] \"Brazil USAID-Brasilia\"                          \n[12] \"Burma USAID - Rangoon\"                          \n[13] \"Burundi USAID-Bujumbura\"                        \n[14] \"Cambodia USAID-Phnom Penh\"                      \n[15] \"Colombia USAID-Bogota\"                          \n[16] \"Democratic Republic of the Congo USAID-Kinshasa\"\n[17] \"Dominican Republic USAID-Santo Domingo\"         \n[18] \"East Africa USAID-Kenya\"                        \n[19] \"Ecuador USAID-Quito\"                            \n[20] \"Egypt USAID-Cairo\"                              \n[21] \"El Salvador USAID-San Salvador\"                 \n[22] \"Ethiopia USAID-Addis Ababa\"                     \n[23] \"Georgia USAID-Tbilisi\"                          \n[24] \"Ghana USAID-Accra\"                              \n[25] \"Guatemala USAID-Guatemala City\"                 \n[26] \"Guinea USAID-Conakry\"                           \n[27] \"Haiti USAID-Port Au Prince\"                     \n[28] \"Honduras USAID-Tegucigalpa\"                     \n[29] \"Hungary USAID-Budapest\"                         \n[30] \"India USAID-New Delhi\"                          \n[31] \"Indonesia USAID-Jakarta\"                        \n[32] \"Iraq Assistance Office\"                         \n[33] \"Iraq USAID-Baghdad\"                             \n[34] \"Jamaica USAID-Kingston\"                         \n[35] \"Jordan USAID-Amman\"                             \n[36] \"Kazakhstan USAID-Almaty\"                        \n[37] \"Kenya USAID-Nairobi\"                            \n[38] \"Kosovo USAID-Pristina\"                          \n[39] \"Lebanon USAID-Beirut\"                           \n[40] \"Liberia USAID-Monrovia\"                         \n[41] \"Macedonia USAID-Skopje\"                         \n[42] \"Madagascar USAID-Antananarivo\"                  \n[43] \"Malawi USAID-Lilongwe\"                          \n[44] \"Mali USAID -Bamako\"                             \n[45] \"Mexico USAID-Mexico City\"                       \n[46] \"Middle East Regional Platform USAID-MERP\"       \n[47] \"Moldova USAID-Chisinau\"                         \n[48] \"Mongolia USAID-Ulaanbaatar\"                     \n[49] \"Morocco USAID-Rabat\"                            \n[50] \"Mozambique USAID-Maputo\"                        \n[51] \"Nepal USAID-Kathmandu\"                          \n[52] \"Nicaragua USAID-Managua\"                        \n[53] \"Nigeria USAID-Abuja\"                            \n[54] \"Pakistan USAID-Islamabad\"                       \n[55] \"Panama USAID-Panama City\"                       \n[56] \"Paraguay USAID-Asuncion\"                        \n[57] \"Peru USAID-Lima\"                                \n[58] \"Philippines USAID-Manila\"                       \n[59] \"Rwanda USAID-Kigali\"                            \n[60] \"Senegal USAID-Dakar\"                            \n[61] \"Serbia USAID-Belgrade\"                          \n[62] \"South Africa USAID-Pretoria\"                    \n[63] \"South Sudan (USAID)-Juba\"                       \n[64] \"Sri Lanka USAID-Colombo\"                        \n[65] \"Sudan USAID-Khartoum\"                           \n[66] \"Tajikistan USAID-Dushanbe\"                      \n[67] \"Tanzania USAID-Dar es Salaam\"                   \n[68] \"Thailand USAID-Bangkok\"                         \n[69] \"Uganda USAID-Kampala\"                           \n[70] \"Ukraine USAID-Kiev\"                             \n[71] \"Uzbekistan USAID-Tashkent\"                      \n[72] \"West Africa USAID-Ghana\"                        \n[73] \"West Bank\"                                      \n[74] \"Gaza USAID-West Bank\"                           \n[75] \"Yemen USAID-Sanaa\"                              \n[76] \"Zambia USAID-Lusaka\"                            \n[77] \"Zimbabwe USAID-Harare\"                          \n[78] \"USAID\"                                          \n[79] \"USAID - Barbados and Eastern Caribbean\"         \n[80] \"USAID-VIETNAM\"                                  \n\n$`Education and Research`\n  [1] \"Advanced Research Projects Agency Energy\"          \n  [2] \"Advanced Research Projects Agency for Health\"      \n  [3] \"Agency for Health Care Research and Quality\"       \n  [4] \"Air Force Academy\"                                 \n  [5] \"Air Force Office of Scientific Research\"           \n  [6] \"Army Contracting Command - Benet Laboratories\"     \n  [7] \"Bureau Of Educational and Cultural Affairs\"        \n  [8] \"Centers for Disease Control - ATSDR\"               \n  [9] \"Centers for Disease Control - CFA\"                 \n [10] \"Centers for Disease Control - CGH\"                 \n [11] \"Centers for Disease Control - CSELS\"               \n [12] \"Centers for Disease Control - NCBDDD\"              \n [13] \"Centers for Disease Control - NCCDPHP\"             \n [14] \"Centers for Disease Control - NCEH\"                \n [15] \"Centers for Disease Control - NCEZID\"              \n [16] \"Centers for Disease Control - NCHHSTP\"             \n [17] \"Centers for Disease Control - NCHS\"                \n [18] \"Centers for Disease Control - NCIPC\"               \n [19] \"Centers for Disease Control - NCIRD\"               \n [20] \"Centers for Disease Control - NIOSH\"               \n [21] \"Centers for Disease Control - OD\"                  \n [22] \"Centers for Disease Control - OPHPR\"               \n [23] \"Centers for Disease Control - OSTLTS\"              \n [24] \"Centers for Disease Control and Prevention\"        \n [25] \"Centers for Disease Control and Prevention - ERA\"  \n [26] \"Centers for Medicare & Medicaid Services\"          \n [27] \"Chief Evaluation Office\"                           \n [28] \"CMS Consumer Operated and Oriented Plan Program\"   \n [29] \"CMS-Consumer Information & Insurance Oversight\"    \n [30] \"DARPA - Biological Technologies Office\"            \n [31] \"DARPA - Defense Sciences Office\"                   \n [32] \"DARPA - Information Innovation Office\"             \n [33] \"DARPA - Information Processing Technology Office\"  \n [34] \"DARPA - Microsystems Technology Office\"            \n [35] \"DARPA - Strategic Technology Office\"               \n [36] \"DARPA - Tactical Technology Office\"                \n [37] \"DARPA - Transformational Convergence Technology\"   \n [38] \"DARPA-MTO-BAA-09-25\"                               \n [39] \"Defense Advanced Research Projects Agency\"         \n [40] \"Defense Health Agency\"                             \n [41] \"Defense Intelligence Agency\"                       \n [42] \"Department of Education\"                           \n [43] \"DoD Education Activity\"                            \n [44] \"DOT - FAA Aviation Research Grants\"                \n [45] \"DOT - FAA Centers of Excellence\"                   \n [46] \"DOT Federal Aviation Administration\"               \n [47] \"Economic Research Service\"                         \n [48] \"Engineer Research and Development Center\"          \n [49] \"FAA - Aviation Next Gen\"                           \n [50] \"FAA-COE-AJFE\"                                      \n [51] \"FAA-COE-GA\"                                        \n [52] \"FAA-COE-TTHP\"                                      \n [53] \"Faculty Exchange Program 10.613\"                   \n [54] \"Fish and Wildlife Service\"                         \n [55] \"Fisheries & Habitat Conservation\"                  \n [56] \"Food and Drug Administration\"                      \n [57] \"Food and Nutrition Service\"                        \n [58] \"Food Safety Inspection Service\"                    \n [59] \"Foreign Agricultural Service\"                      \n [60] \"Forest Service\"                                    \n [61] \"Geological Survey\"                                 \n [62] \"Health Resources and Services Administration\"      \n [63] \"Indian Health Service\"                             \n [64] \"Institute of Museum and Library Services\"          \n [65] \"Internal Revenue Service\"                          \n [66] \"International Agricultural Educ Fellowship 10.619\" \n [67] \"Library of Congress\"                               \n [68] \"NASA Ames Research Center\"                         \n [69] \"NASA Armstrong Flight Research Center\"             \n [70] \"NASA Glenn Research Center\"                        \n [71] \"NASA Goddard Space Flight Center\"                  \n [72] \"NASA Headquarters\"                                 \n [73] \"NASA Johnson Space Center\"                         \n [74] \"NASA Kennedy Space Center\"                         \n [75] \"NASA Langley Research Center\"                      \n [76] \"NASA Marshall Space Flight Center\"                 \n [77] \"NASA Stennis Space Center\"                         \n [78] \"National Aeronautics and Space Administration\"     \n [79] \"National Archives and Records Administration\"      \n [80] \"National Endowment for the Arts\"                   \n [81] \"National Endowment for the Humanities\"             \n [82] \"National Energy Technology Laboratory\"             \n [83] \"National Geospatial-Intelligence Agency\"           \n [84] \"National Highway Traffic Safety Administration\"    \n [85] \"National Institute of Corrections\"                 \n [86] \"National Institute of Food and Agriculture\"        \n [87] \"National Institute of Justice\"                     \n [88] \"National Institute of Standards and Technology\"    \n [89] \"National Institutes of Health\"                     \n [90] \"National Oceanic and Atmospheric Administration\"   \n [91] \"National Park Service\"                             \n [92] \"National Science Foundation\"                       \n [93] \"National Telecommunications and Information Admini\"\n [94] \"National Veterans Sports Programs\"                 \n [95] \"Natural Resources Conservation Service\"            \n [96] \"Naval Research Laboratory\"                         \n [97] \"Nuclear Regulatory Commission\"                     \n [98] \"Office of Science\"                                 \n [99] \"Office of the Assistant Secretary for Health\"      \n[100] \"Office of the Director of National Intelligence\"   \n[101] \"Office of the National Coordinator\"                \n[102] \"Office of the Secretary\"                           \n[103] \"Occupational Safety and Health Administration\"     \n[104] \"Pipeline and Hazardous Materials Safety Admin\"     \n[105] \"Risk Management Agency\"                            \n[106] \"Risk Management Education\"                         \n[107] \"Rural Business-Cooperative Service\"                \n[108] \"Rural Housing Service\"                             \n[109] \"Rural Utilities Service\"                           \n[110] \"Scientific Cooperation and Research 10.961\"        \n[111] \"Social Security Administration\"                    \n[112] \"Substance Abuse and Mental Health Services Admin\"  \n[113] \"Substance Abuse and Mental Health Services Adminis\"\n[114] \"Technical Agricultural Assistance 10.960\"          \n[115] \"Uniformed Services Univ. of the Health Sciences\"   \n[116] \"USUHS Medical - Non- Research Projects\"            \n[117] \"USUHS Medical Research Projects\"                   \n[118] \"Veterans Employment and Training Service\"          \n[119] \"Volunteer Income Tax Assistance\"                   \n[120] \"Woodrow Wilson Center\"                             \n\n$`Agriculture and Environment`\n [1] \"Agricultural Marketing Service\"                    \n [2] \"Agricultural Trade Promotion Program 10.618\"       \n [3] \"Animal and Plant Health Inspection Service\"        \n [4] \"Bureau of Land Management\"                         \n [5] \"Bureau of Ocean Energy Management\"                 \n [6] \"Bureau of Reclamation\"                             \n [7] \"Bureau of Reclamation - Denver Office\"             \n [8] \"Bureau of Reclamation - Great Plains Region\"       \n [9] \"Bureau of Reclamation - Lower Colorado Region\"     \n[10] \"Bureau of Reclamation - Mid-Pacific Region\"        \n[11] \"Bureau of Reclamation - Pacific Northwest Region\"  \n[12] \"Bureau of Reclamation - Upper Colorado Region\"     \n[13] \"Bureau of Reclamation-Upper Columbia Area Office\"  \n[14] \"Bureau of Reclamation\"                             \n[15] \"Denver Office\"                                     \n[16] \"Bureau of Reclamation\"                             \n[17] \"Mid-Pacific Regional Office\"                       \n[18] \"Bureau of Safety and Environmental Enforcement\"    \n[19] \"Department of Agriculture\"                         \n[20] \"Endangered Species\"                                \n[21] \"Environmental Management Consolidated Business Cen\"\n[22] \"Environmental Protection Agency\"                   \n[23] \"Farm Production and Conservation Business Center\"  \n[24] \"Farm Service Agency\"                               \n[25] \"Fish and Wildlife Service\"                         \n[26] \"Fisheries & Habitat Conservation\"                  \n[27] \"Forest Service\"                                    \n[28] \"Migratory Birds\"                                   \n[29] \"National Energy Technology Laboratory\"             \n[30] \"National Oceanic and Atmospheric Administration\"   \n[31] \"Natural Resources Conservation Service\"            \n[32] \"Office of Science\"                                 \n[33] \"Risk Management Agency\"                            \n[34] \"Rural Business-Cooperative Service\"                \n[35] \"Rural Housing Service\"                             \n[36] \"Rural Utilities Service\"                           \n\n$`Infrastructure and Transportation`\n  [1] \"```69A345 Office of the Under Secretary for Policy\"\n  [2] \"69A350 OSDBU\"                                      \n  [3] \"69A355 Research and Technology\"                    \n  [4] \"ACC APG - Natick\"                                  \n  [5] \"ACC-APG-Aberdeen Division A\"                       \n  [6] \"ACC-APG-Belvoir\"                                   \n  [7] \"ACC-APG-Detrick\"                                   \n  [8] \"ACC-APG-Edgewood\"                                  \n  [9] \"ACC-APG-Fort Huachuca\"                             \n [10] \"Air Force -- Materiel Command\"                     \n [11] \"Air Force -- Research Lab\"                         \n [12] \"Air Force Academy\"                                 \n [13] \"Air Force Office of Scientific Research\"           \n [14] \"Airport Improvement Program Discretionary Grants\"  \n [15] \"Alaska District\"                                   \n [16] \"Army Contracting Command - Benet Laboratories\"     \n [17] \"Army Contracting Command - New Jersey\"             \n [18] \"Army Contracting Command Rock Island\"              \n [19] \"Bureau of Land Management\"                         \n [20] \"Bureau of Ocean Energy Management\"                 \n [21] \"Bureau of Reclamation\"                             \n [22] \"Bureau of Reclamation - Denver Office\"             \n [23] \"Bureau of Reclamation - Great Plains Region\"       \n [24] \"Bureau of Reclamation - Lower Colorado Region\"     \n [25] \"Bureau of Reclamation - Mid-Pacific Region\"        \n [26] \"Bureau of Reclamation - Pacific Northwest Region\"  \n [27] \"Bureau of Reclamation - Upper Colorado Region\"     \n [28] \"Bureau of Reclamation-Upper Columbia Area Office\"  \n [29] \"Bureau of Reclamation\"                             \n [30] \"Denver Office\"                                     \n [31] \"Bureau of Reclamation\"                             \n [32] \"Mid-Pacific Regional Office\"                       \n [33] \"Bureau of Safety and Environmental Enforcement\"    \n [34] \"Chicago Service Center\"                            \n [35] \"DARPA - Biological Technologies Office\"            \n [36] \"DARPA - Defense Sciences Office\"                   \n [37] \"DARPA - Information Innovation Office\"             \n [38] \"DARPA - Information Processing Technology Office\"  \n [39] \"DARPA - Microsystems Technology Office\"            \n [40] \"DARPA - Strategic Technology Office\"               \n [41] \"DARPA - Tactical Technology Office\"                \n [42] \"DARPA - Transformational Convergence Technology\"   \n [43] \"Defense Advanced Research Projects Agency\"         \n [44] \"Defense Health Agency\"                             \n [45] \"Defense Intelligence Agency\"                       \n [46] \"Defense Logistics Agency\"                          \n [47] \"Defense Threat Reduction Agency\"                   \n [48] \"Department of Transportation\"                      \n [49] \"Dept of the Army -- Materiel Command\"              \n [50] \"Dept. of the Army  --  Corps of Engineers\"         \n [51] \"Dept. of the Army -- Space & Missle Defense Comman\"\n [52] \"Dept. of the Army -- USAMRAA\"                      \n [53] \"DOT - FAA Aviation Research Grants\"                \n [54] \"DOT - FAA Centers of Excellence\"                   \n [55] \"DOT - Federal Railroad Administration\"             \n [56] \"DOT Federal Aviation Administration\"               \n [57] \"DOT Federal Highway Administration\"                \n [58] \"DOT OSDBU\"                                         \n [59] \"DOT-Federal Motor Carrier Safety Administration\"   \n [60] \"DOT-Federal Transit Administration - Inactive Site\"\n [61] \"DOT/Federal Transit Administration\"                \n [62] \"Economic Development Administration\"               \n [63] \"Engineer Research and Development Center\"          \n [64] \"FAA - Aviation Next Gen\"                           \n [65] \"FAA-COE-AJFE\"                                      \n [66] \"FAA-COE-GA\"                                        \n [67] \"FAA-COE-TTHP\"                                      \n [68] \"Federal Communications Commission\"                 \n [69] \"Federal Mediation and Conciliation Service\"        \n [70] \"Federal Motor Carrier Safety Administration\"       \n [71] \"Federal Transit Administration\"                    \n [72] \"Fort Worth District\"                               \n [73] \"Kansas City District\"                              \n [74] \"Maritime Administration\"                           \n [75] \"NASA Ames Research Center\"                         \n [76] \"NASA Armstrong Flight Research Center\"             \n [77] \"NASA Glenn Research Center\"                        \n [78] \"NASA Goddard Space Flight Center\"                  \n [79] \"NASA Headquarters\"                                 \n [80] \"NASA Johnson Space Center\"                         \n [81] \"NASA Kennedy Space Center\"                         \n [82] \"NASA Langley Research Center\"                      \n [83] \"NASA Marshall Space Flight Center\"                 \n [84] \"NASA Stennis Space Center\"                         \n [85] \"National Aeronautics and Space Administration\"     \n [86] \"National Highway Traffic Safety Administration\"    \n [87] \"National Oceanic and Atmospheric Administration\"   \n [88] \"National Telecommunications and Information Admini\"\n [89] \"Naval Air Warfare Center Aircraft Div. Lakehurst\"  \n [90] \"NAVAL FACILITIES ENGINEERING COMMAND\"              \n [91] \"Naval Facilities Engineering Command Southwest\"    \n [92] \"Naval Information Warfare Center Pacific\"          \n [93] \"NAVAL MEDICAL LOGISTICS COMMAND\"                   \n [94] \"Naval Research Laboratory\"                         \n [95] \"Naval Supply Systems Command\"                      \n [96] \"Naval Surface Warfare Center - Carderock\"          \n [97] \"NAVFAC Atlantic\"                                   \n [98] \"NAVFAC Washington DC\"                              \n [99] \"NCA Contracting\"                                   \n[100] \"Nebraska State Office\"                             \n[101] \"Nuclear Regulatory Commission\"                     \n[102] \"NUWC Division Keyport\"                             \n[103] \"Office of Local Defense Community Cooperation\"     \n[104] \"Office of the Secretary\"                           \n[105] \"Omaha District\"                                    \n[106] \"Pipeline and Hazardous Materials Safety Admin\"     \n[107] \"Region 1\"                                          \n[108] \"Region 10\"                                         \n[109] \"Region 2\"                                          \n[110] \"Region 3\"                                          \n[111] \"Region 4\"                                          \n[112] \"Region 5\"                                          \n[113] \"Region 6\"                                          \n[114] \"Region 7\"                                          \n[115] \"Region 8\"                                          \n[116] \"Region 9\"                                          \n[117] \"Risk Management Agency\"                            \n[118] \"Rural Utilities Service\"                           \n[119] \"Savannah District\"                                 \n[120] \"Seattle District\"                                  \n[121] \"SPAWAR SYSTEMS CENTER\"                             \n[122] \"Transportation Security Administration\"            \n[123] \"U.S. Dept. of Treasury RESTORE Act Program\"        \n[124] \"United States Coast Guard\"                         \n[125] \"United States Marine Corps\"                        \n[126] \"USACE Portland District\"                           \n[127] \"USAF 347 Contracting Squadron\"                     \n[128] \"Walla Walla District\"                              \n[129] \"Washington Headquarters Services```\"               \n\n$`Business and Economic Development`\n [1] \"Economic Development Administration\"               \n [2] \"Small Business Administration\"                     \n [3] \"Community Development Financial Institutions\"      \n [4] \"Rural Business-Cooperative Service\"                \n [5] \"Employment and Training Administration\"            \n [6] \"Office of Local Defense Community Cooperation\"     \n [7] \"Economic Research Service\"                         \n [8] \"Agricultural Marketing Service\"                    \n [9] \"Agricultural Trade Promotion Program 10.618\"       \n[10] \"Bureau of Economic and Business Affairs\"           \n[11] \"Trade Policy and Geographic Affairs\"               \n[12] \"Market Access Program 10.601\"                      \n[13] \"Foreign Agricultural Service\"                      \n[14] \"Foreign Market Development Cooperator Prog 10600\"  \n[15] \"Technical Assistance for Specialty Crops 10.604\"   \n[16] \"Jobs and Innovation Accelerator Challenge\"         \n[17] \"Energy Cluster Program\"                            \n[18] \"DOT - FAA Centers of Excellence\"                   \n[19] \"DOT Federal Highway Administration\"                \n[20] \"DOT OSDBU\"                                         \n[21] \"DOT-Federal Motor Carrier Safety Administration\"   \n[22] \"DOT-Federal Transit Administration - Inactive Site\"\n[23] \"DOT/Federal Transit Administration\"                \n[24] \"Federal Communications Commission\"                 \n[25] \"National Business Center\"                          \n[26] \"National Telecommunications and Information Admini\"\n[27] \"U.S. Dept. of Treasury RESTORE Act Program\"        \n[28] \"Volunteer Income Tax Assistance\"                   \n[29] \"Low Income Taxpayer Clinic\"                        \n[30] \"Tax Counseling for the Elderly\"                    \n[31] \"CMS Consumer Operated and Oriented Plan Program\"   \n[32] \"CMS-Consumer Information & Insurance Oversight\"    \n[33] \"Office of Acquisitions Management\"                 \n[34] \"Office of Procurement Operations - Grants Division\"\n[35] \"Office of the Secretary\"                           \n[36] \"Office on Violence Against Women\"                  \n[37] \"Veterans Employment and Training Service\"          \n[38] \"Veterans Employment Pay for Success\"               \n[39] \"Office of Disability Employment Policy\"            \n[40] \"Office of Partnerships and Public Engagements\"     \n[41] \"Risk Management Agency\"                            \n[42] \"Risk Management Education\"                         \n[43] \"Office of the Assistant Secretary for Health\"      \n[44] \"Office of the National Coordinator\"                \n[45] \"Office of the Director of National Intelligence\"   \n[46] \"Office of the Middle East Partnership Initiative\"  \n[47] \"Office to Monitor-Combat Trafficking in Persons\"   \n[48] \"Office of Global Womens Issues\"                    \n[49] \"Office of Global Criminal Justice\"                 \n[50] \"Office of Justice Programs\"                        \n[51] \"Office of Juvenile Justice Delinquency Prevention\" \n[52] \"Office for Victims of Crime\"                       \n[53] \"Office of Science\"                                 \n[54] \"Office of Surface Mining\"                          \n[55] \"Office of Mental Health and Suicide Prevention\"    \n[56] \"Office of National Drug Control Policy\"            \n[57] \"Office of the Secretary\"                           \n[58] \"Office of Policy ORES\"                             \n[59] \"Office of Acquisitions Management\"                 \n[60] \"Office of Procurement Operations - Grants Division\"\n[61] \"Office of the Secretary\"                           \n[62] \"Office on Violence Against Women\"                  \n[63] \"Veterans Employment and Training Service\"          \n[64] \"Veterans Employment Pay for Success\"               \n[65] \"Office of Disability Employment Policy\"            \n[66] \"Office of Partnerships and Public Engagements\"     \n[67] \"Risk Management Agency\"                            \n[68] \"Risk Management Education\"                         \n[69] \"Office of the Assistant Secretary for Health\"      \n[70] \"Office of the National Coordinator\"                \n[71] \"Office of the Director of National Intelligence\"   \n[72] \"Office of the Middle East Partnership Initiative\"  \n[73] \"Office to Monitor-Combat Trafficking in Persons\"   \n[74] \"Office of Global Womens Issues\"                    \n[75] \"Office of Global Criminal Justice\"                 \n[76] \"Office of Justice Programs\"                        \n[77] \"Office of Juvenile Justice Delinquency Prevention\" \n[78] \"Office for Victims of Crime\"                       \n[79] \"Office of Science\"                                 \n[80] \"Office of Surface Mining\"                          \n[81] \"Office of Mental Health and Suicide Prevention\"    \n[82] \"Office of National Drug Control Policy\"            \n\n$`Arts and Culture`\n[1] \"National Endowment for the Arts\"             \n[2] \"National Endowment for the Humanities\"       \n[3] \"Institute of Museum and Library Services\"    \n[4] \"Library of Congress\"                         \n[5] \"National Archives and Records Administration\"\n[6] \"Smithsonian Institution\"                     \n\n$`Social Services and Community Development`\n [1] \"Administration for Children & Families - ACYF/FYSB\"\n [2] \"Administration for Children and Families\"          \n [3] \"Administration for Children and Families - ACYF/CB\"\n [4] \"Administration for Children and Families - ANA\"    \n [5] \"Administration for Children and Families - OCC\"    \n [6] \"Administration for Children and Families - OCS\"    \n [7] \"Administration for Children and Families - OCSE\"   \n [8] \"Administration for Children and Families - OFA\"    \n [9] \"Administration for Children and Families - OHS\"    \n[10] \"Administration for Children and Families - OHSEPR\" \n[11] \"Administration for Children and Families - OPRE\"   \n[12] \"Administration for Children and Families - ORR\"    \n[13] \"Administration for Children and Families-IOAS-OTIP\"\n[14] \"Administration for Community Living\"               \n[15] \"Administration on Aging\"                           \n[16] \"AmeriCorps\"                                        \n[17] \"Community Capacity Development Office\"             \n[18] \"Community Development Financial Institutions\"      \n[19] \"Community Oriented Policing Services\"              \n[20] \"Corporation for National and Community Service\"    \n[21] \"Department of Housing and Urban Development\"       \n[22] \"Employment and Training Administration\"            \n[23] \"Health Resources and Services Administration\"      \n[24] \"Homeless Providers Grant and Per Diem Program\"     \n[25] \"Housing and Urban Development\"                     \n[26] \"Office of Juvenile Justice Delinquency Prevention\" \n[27] \"Office of Local Defense Community Cooperation\"     \n[28] \"Office of the Assistant Secretary for Health\"      \n[29] \"Office on Violence Against Women\"                  \n[30] \"Rural Business-Cooperative Service\"                \n[31] \"Rural Housing Service\"                             \n[32] \"Rural Utilities Service\"                           \n[33] \"Social Security Administration\"                    \n[34] \"Substance Abuse and Mental Health Services Admin\"  \n[35] \"Substance Abuse and Mental Health Services Adminis\"\n[36] \"Supportive Services for Veteran Families\"          \n[37] \"Veterans Employment and Training Service\"          \n[38] \"Veterans Employment Pay for Success\"               \n[39] \"Veterans Legacy Grants Program\"                    \n[40] \"Volunteer Income Tax Assistance\"                   \n[41] \"Womens Bureau\"                                     \n```\n:::\n:::\n\n\n## Add categories to dataframe\n\nFinally, I'll add the category labels to the `grant_opportunity_details` dataframe. Since the categories are not mutually exclusive, I'll encode them as boolean.\n\n\n::: {.cell}\n\n```{.r .cell-code}\ncategories_snakecase <- snakecase::to_snake_case(categories)\n\nfor(i in seq(1, length(categories_snakecase))){\n  grant_opportunity_details <- grant_opportunity_details %>%\n    mutate(!!categories_snakecase[i] := agency_name %in% agencies_categorized[i][[1]])\n}\n```\n:::\n\n\n# Data analysis\n\nNow that I have a list of agency categories, I can do some analysis. One question I might ask is how much total estimated funding is allocated to each of the agency categories?\n\n\n::: {.cell}\n\n```{.r .cell-code}\nestimated_total_funding <- data.frame('category' = c(), 'estimated_total_funding' = c())\n\nfor (c in categories_snakecase){\n  estimated_total_funding <-\n    estimated_total_funding %>%\n      bind_rows(data.frame(\n        'category' = c,\n        'estimated_total_funding' = sum((grant_opportunity_details %>% filter(!!sym(c)))$estimated_total_program_funding, na.rm=T)\n      ))\n}\n\nestimated_total_funding <- \n  estimated_total_funding %>%\n    mutate(funding_billions = numform::f_bills(estimated_total_funding, digits=-8)) %>%\n    arrange(desc(estimated_total_funding))\n\nestimated_total_funding %>%\n  select(category, funding_billions)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n                                    category funding_billions\n1                     science_and_technology            52.9B\n2                agriculture_and_environment            39.7B\n3                     education_and_research            20.3B\n4          infrastructure_and_transportation            17.7B\n5          business_and_economic_development              16B\n6  social_services_and_community_development            12.6B\n7                       defense_and_military             9.4B\n8                        health_and_medicine             2.6B\n9                          international_aid             2.6B\n10                          arts_and_culture              .1B\n```\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nestimated_total_funding %>%\n  arrange(estimated_total_funding) -> estimated_total_funding_ordered\n\nestimated_total_funding_ordered %>%\n  arrange(estimated_total_funding) %>%\n    ggplot(aes(x = fct_inorder(category), y = estimated_total_funding)) +\n      geom_col() +\n      coord_flip() +\n      # Convert back from snake case to sentence case for better human readability\n      scale_x_discrete(labels=unique(snakecase::to_sentence_case(estimated_total_funding_ordered$category))) +\n      scale_y_continuous(labels = scales::unit_format(unit = \"B\", scale = 1e-9)) +\n      labs(x = '', y = 'Funding in Billions', title = 'Funding by US Government Agency Category')\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-9-1.png){width=672}\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\n#ggsave(\"social-image.png\", height=960, width=1344, units = 'px', dpi=150)\n```\n:::\n",
    "supporting": [
      "index_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}